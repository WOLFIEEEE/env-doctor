"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[294],{1287(e,n,o){o.r(n),o.d(n,{assets:()=>t,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"examples/monorepo","title":"Monorepo Setup","description":"Configure env-doctor for monorepo projects with multiple packages.","source":"@site/docs/examples/monorepo.md","sourceDirName":"examples","slug":"/examples/monorepo","permalink":"/env-doctor/docs/examples/monorepo","draft":false,"unlisted":false,"editUrl":"https://github.com/khushwantparihar/env-doctor/tree/main/docs/docs/examples/monorepo.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"Basic Usage","permalink":"/env-doctor/docs/examples/basic-usage"},"next":{"title":"Custom Rules","permalink":"/env-doctor/docs/examples/custom-rules"}}');var r=o(4848),c=o(8453);const a={sidebar_position:2},i="Monorepo Setup",t={},l=[{value:"Project Structure",id:"project-structure",level:2},{value:"Root Configuration",id:"root-configuration",level:2},{value:"Per-Package Scanning",id:"per-package-scanning",level:2},{value:"Package-Specific Config",id:"package-specific-config",level:2},{value:"Shared Environment File",id:"shared-environment-file",level:2},{value:"Workspace Scripts",id:"workspace-scripts",level:2},{value:"CI Integration",id:"ci-integration",level:2},{value:"Turborepo Integration",id:"turborepo-integration",level:2},{value:"Best Practices",id:"best-practices",level:2}];function p(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"monorepo-setup",children:"Monorepo Setup"})}),"\n",(0,r.jsx)(n.p,{children:"Configure env-doctor for monorepo projects with multiple packages."}),"\n",(0,r.jsx)(n.h2,{id:"project-structure",children:"Project Structure"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"my-monorepo/\n\u251c\u2500\u2500 package.json\n\u251c\u2500\u2500 .env                      # Root env file\n\u251c\u2500\u2500 .env.example\n\u251c\u2500\u2500 env-doctor.config.js      # Root config\n\u251c\u2500\u2500 packages/\n\u2502   \u251c\u2500\u2500 web/\n\u2502   \u2502   \u251c\u2500\u2500 package.json\n\u2502   \u2502   \u251c\u2500\u2500 .env.local        # Package-specific\n\u2502   \u2502   \u2514\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 api/\n\u2502   \u2502   \u251c\u2500\u2500 package.json\n\u2502   \u2502   \u251c\u2500\u2500 .env.local\n\u2502   \u2502   \u2514\u2500\u2500 src/\n\u2502   \u2514\u2500\u2500 shared/\n\u2502       \u251c\u2500\u2500 package.json\n\u2502       \u2514\u2500\u2500 src/\n\u2514\u2500\u2500 apps/\n    \u2514\u2500\u2500 admin/\n        \u251c\u2500\u2500 package.json\n        \u2514\u2500\u2500 src/\n"})}),"\n",(0,r.jsx)(n.h2,{id:"root-configuration",children:"Root Configuration"}),"\n",(0,r.jsx)(n.p,{children:"Create a root config that scans all packages:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// env-doctor.config.js\nmodule.exports = {\n  envFiles: ['.env'],\n  templateFile: '.env.example',\n  \n  include: [\n    'packages/*/src/**/*.{ts,tsx,js,jsx}',\n    'apps/*/src/**/*.{ts,tsx,js,jsx}'\n  ],\n  \n  exclude: [\n    'node_modules',\n    '**/node_modules',\n    '**/dist',\n    '**/build'\n  ],\n  \n  framework: 'auto',\n  \n  variables: {\n    // Shared variables\n    NODE_ENV: {\n      enum: ['development', 'production', 'test']\n    },\n    LOG_LEVEL: {\n      enum: ['debug', 'info', 'warn', 'error'],\n      default: 'info'\n    }\n  }\n};\n"})}),"\n",(0,r.jsx)(n.h2,{id:"per-package-scanning",children:"Per-Package Scanning"}),"\n",(0,r.jsx)(n.p,{children:"Scan individual packages:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Scan web package\nnpx env-doctor packages/web\n\n# Scan api package  \nnpx env-doctor packages/api\n"})}),"\n",(0,r.jsx)(n.h2,{id:"package-specific-config",children:"Package-Specific Config"}),"\n",(0,r.jsx)(n.p,{children:"Create package-level configs for specific rules:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// packages/api/env-doctor.config.js\nmodule.exports = {\n  envFiles: ['../../.env', '.env.local'],\n  templateFile: '../../.env.example',\n  \n  include: ['src/**/*.ts'],\n  \n  framework: 'node',\n  \n  variables: {\n    DATABASE_URL: {\n      required: true,\n      secret: true\n    },\n    REDIS_URL: {\n      required: true\n    }\n  }\n};\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// packages/web/env-doctor.config.js\nmodule.exports = {\n  envFiles: ['../../.env', '.env.local'],\n  templateFile: '../../.env.example',\n  \n  include: ['src/**/*.{ts,tsx}'],\n  \n  framework: 'nextjs',\n  \n  variables: {\n    NEXT_PUBLIC_API_URL: {\n      required: true,\n      type: 'url'\n    }\n  }\n};\n"})}),"\n",(0,r.jsx)(n.h2,{id:"shared-environment-file",children:"Shared Environment File"}),"\n",(0,r.jsxs)(n.p,{children:["For monorepos, use a root ",(0,r.jsx)(n.code,{children:".env"})," with package prefixes:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# .env\nNODE_ENV=development\n\n# API Package\nAPI_DATABASE_URL=postgres://localhost:5432/api\nAPI_REDIS_URL=redis://localhost:6379\nAPI_JWT_SECRET=secret\n\n# Web Package\nWEB_NEXT_PUBLIC_API_URL=http://localhost:3001\n\n# Admin App\nADMIN_API_URL=http://localhost:3001/admin\n"})}),"\n",(0,r.jsx)(n.h2,{id:"workspace-scripts",children:"Workspace Scripts"}),"\n",(0,r.jsxs)(n.p,{children:["Add scripts to your root ",(0,r.jsx)(n.code,{children:"package.json"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "scripts": {\n    "env:check": "env-doctor",\n    "env:check:all": "pnpm -r exec env-doctor",\n    "env:check:web": "env-doctor packages/web",\n    "env:check:api": "env-doctor packages/api"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"ci-integration",children:"CI Integration"}),"\n",(0,r.jsx)(n.p,{children:"Check all packages in CI:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"# .github/workflows/ci.yml\njobs:\n  env-check:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: pnpm/action-setup@v4\n      - uses: actions/setup-node@v4\n      \n      - run: pnpm install\n      \n      # Check root\n      - name: Check root environment\n        run: npx env-doctor --ci\n        \n      # Check each package\n      - name: Check packages\n        run: pnpm -r exec env-doctor --ci\n"})}),"\n",(0,r.jsx)(n.h2,{id:"turborepo-integration",children:"Turborepo Integration"}),"\n",(0,r.jsx)(n.p,{children:"For Turborepo projects, add env-doctor to your pipeline:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'// turbo.json\n{\n  "pipeline": {\n    "env:check": {\n      "cache": false\n    },\n    "build": {\n      "dependsOn": ["env:check"],\n      "outputs": ["dist/**"]\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Root config for shared rules"})," - Common patterns, ignored variables"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Package configs for specific rules"})," - Required variables per package"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Single .env.example"})," - Document all variables in one place"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Prefix by package"})," - Avoid conflicts with namespaced variables"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"CI checks all packages"})," - Ensure nothing is missed"]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},8453(e,n,o){o.d(n,{R:()=>a,x:()=>i});var s=o(6540);const r={},c=s.createContext(r);function a(e){const n=s.useContext(c);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);