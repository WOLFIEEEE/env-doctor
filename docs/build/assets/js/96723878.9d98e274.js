"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[269],{5395(e,n,s){s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"features/secret-detection","title":"Secret Detection","description":"Detect exposed secrets, API keys, and credentials in your .env files.","source":"@site/docs/features/secret-detection.md","sourceDirName":"features","slug":"/features/secret-detection","permalink":"/env-doctor/docs/features/secret-detection","draft":false,"unlisted":false,"editUrl":"https://github.com/khushwantparihar/env-doctor/tree/main/docs/docs/features/secret-detection.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"docsSidebar","previous":{"title":"Type Checking","permalink":"/env-doctor/docs/features/type-checking"},"next":{"title":"Sync Check","permalink":"/env-doctor/docs/features/sync-check"}}');var i=s(4848),t=s(8453);const c={sidebar_position:4},l="Secret Detection",d={},a=[{value:"How It Works",id:"how-it-works",level:2},{value:"Built-in Patterns",id:"built-in-patterns",level:2},{value:"Variable Name Patterns",id:"variable-name-patterns",level:3},{value:"Provider-Specific Patterns",id:"provider-specific-patterns",level:3},{value:"Value Patterns",id:"value-patterns",level:3},{value:"Example Output",id:"example-output",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Custom Secret Patterns",id:"custom-secret-patterns",level:3},{value:"Marking Variables as Secrets",id:"marking-variables-as-secrets",level:3},{value:"Ignoring False Positives",id:"ignoring-false-positives",level:3},{value:"Placeholder Values",id:"placeholder-values",level:2},{value:"Git History Scanning",id:"git-history-scanning",level:2},{value:"Fixing Leaked Secrets",id:"fixing-leaked-secrets",level:3},{value:"Security Recommendations",id:"security-recommendations",level:2},{value:"Best Practices",id:"best-practices",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"secret-detection",children:"Secret Detection"})}),"\n",(0,i.jsxs)(n.p,{children:["Detect exposed secrets, API keys, and credentials in your ",(0,i.jsx)(n.code,{children:".env"})," files."]}),"\n",(0,i.jsx)(n.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,i.jsx)(n.p,{children:"env-doctor uses pattern matching to detect:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Variable names"})," that suggest secrets"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Value patterns"})," that match known credentials"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"built-in-patterns",children:"Built-in Patterns"}),"\n",(0,i.jsx)(n.h3,{id:"variable-name-patterns",children:"Variable Name Patterns"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Pattern"}),(0,i.jsx)(n.th,{children:"Examples"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"*password*"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"DB_PASSWORD"}),", ",(0,i.jsx)(n.code,{children:"ADMIN_PASSWORD"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"*secret*"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"JWT_SECRET"}),", ",(0,i.jsx)(n.code,{children:"API_SECRET"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"*api_key*"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"STRIPE_API_KEY"}),", ",(0,i.jsx)(n.code,{children:"AWS_API_KEY"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"*token*"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"AUTH_TOKEN"}),", ",(0,i.jsx)(n.code,{children:"ACCESS_TOKEN"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"*private_key*"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"SSH_PRIVATE_KEY"})})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"provider-specific-patterns",children:"Provider-Specific Patterns"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Provider"}),(0,i.jsx)(n.th,{children:"Pattern"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Stripe"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"sk_live_*"}),", ",(0,i.jsx)(n.code,{children:"sk_test_*"}),", ",(0,i.jsx)(n.code,{children:"rk_live_*"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"AWS"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"AKIA*"})," (access key)"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"GitHub"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"ghp_*"}),", ",(0,i.jsx)(n.code,{children:"gho_*"}),", ",(0,i.jsx)(n.code,{children:"github_pat_*"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Google"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"AIza*"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Slack"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"xox*-*"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Twilio"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"AC*"}),", ",(0,i.jsx)(n.code,{children:"SK*"})]})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"value-patterns",children:"Value Patterns"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["JWT tokens (",(0,i.jsx)(n.code,{children:"eyJ*.*.*"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["Private keys (",(0,i.jsx)(n.code,{children:"-----BEGIN * PRIVATE KEY-----"}),")"]}),"\n",(0,i.jsx)(n.li,{children:"Database URLs with credentials"}),"\n",(0,i.jsx)(n.li,{children:"High-entropy strings (likely random)"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"example-output",children:"Example Output"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"\u2717 Exposed Secrets (2 issues)\n\n  STRIPE_SECRET_KEY (Stripe)\n    Variable appears to be a secret - detected as Stripe live secret key\n    Consider using a secure vault or removing from version control.\n    at .env:12\n    Value: sk_li...5678\n\n  DATABASE_URL\n    Variable appears to be a secret - detected as Database URL with credentials\n    at .env:3\n    Value: post...@loc\n"})}),"\n",(0,i.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsx)(n.h3,{id:"custom-secret-patterns",children:"Custom Secret Patterns"}),"\n",(0,i.jsx)(n.p,{children:"Add additional patterns:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// env-doctor.config.js\nmodule.exports = {\n  secretPatterns: [\n    /^MY_COMPANY_SECRET/,\n    /^INTERNAL_TOKEN/\n  ]\n};\n"})}),"\n",(0,i.jsx)(n.h3,{id:"marking-variables-as-secrets",children:"Marking Variables as Secrets"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"variables: {\n  MY_API_KEY: {\n    secret: true  // Always treat as secret\n  }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"ignoring-false-positives",children:"Ignoring False Positives"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"ignore: [\n  'secret:TEST_TOKEN',  // Ignore for TEST_TOKEN\n]\n"})}),"\n",(0,i.jsx)(n.h2,{id:"placeholder-values",children:"Placeholder Values"}),"\n",(0,i.jsx)(n.p,{children:"Secrets with placeholder values are not reported:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# These are safe\nAPI_KEY=your_api_key_here\nSECRET=changeme\nTOKEN=placeholder\n"})}),"\n",(0,i.jsx)(n.h2,{id:"git-history-scanning",children:"Git History Scanning"}),"\n",(0,i.jsx)(n.p,{children:"Check for secrets in commit history:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npx env-doctor scan-history\n"})}),"\n",(0,i.jsx)(n.p,{children:"Output:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"\u26a0 Found 2 potential secret(s) in git history:\n\n  STRIPE_SECRET_KEY\n    Commit: a1b2c3d4\n    File: .env:12\n    Author: developer@example.com\n    Date: 2024-01-15\n    Value: sk_li...5678\n"})}),"\n",(0,i.jsx)(n.h3,{id:"fixing-leaked-secrets",children:"Fixing Leaked Secrets"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Rotate the credential immediately"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Remove from git history"})," using ",(0,i.jsx)(n.code,{children:"git filter-branch"})," or BFG"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsxs)(n.strong,{children:["Add ",(0,i.jsx)(n.code,{children:".env"})," to ",(0,i.jsx)(n.code,{children:".gitignore"})]})}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Add to .gitignore\necho ".env" >> .gitignore\necho ".env.local" >> .gitignore\n'})}),"\n",(0,i.jsx)(n.h2,{id:"security-recommendations",children:"Security Recommendations"}),"\n",(0,i.jsx)(n.p,{children:"When secrets are detected, env-doctor suggests:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Use a secrets manager"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"AWS Secrets Manager"}),"\n",(0,i.jsx)(n.li,{children:"HashiCorp Vault"}),"\n",(0,i.jsx)(n.li,{children:"Doppler"}),"\n",(0,i.jsx)(n.li,{children:"1Password CLI"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["Use ",(0,i.jsx)(n.code,{children:".env.example"})," for documentation"]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# .env.example (safe to commit)\nSTRIPE_SECRET_KEY=\nDATABASE_URL=postgres://user:pass@localhost:5432/db\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Add pre-commit hooks"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npx env-doctor --ci\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Use environment-specific files"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:".env                 # Defaults (committed)\n.env.local           # Local overrides (gitignored)\n.env.production      # Production (gitignored)\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Never commit real secrets"})," - Use ",(0,i.jsx)(n.code,{children:".env.example"})," with placeholders"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Rotate exposed secrets immediately"})," - Treat leaks as critical"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use short-lived credentials"})," - Prefer temporary tokens"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Limit secret scope"})," - Use restricted API keys where possible"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Audit regularly"})," - Run ",(0,i.jsx)(n.code,{children:"env-doctor scan-history"})," periodically"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},8453(e,n,s){s.d(n,{R:()=>c,x:()=>l});var r=s(6540);const i={},t=r.createContext(i);function c(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);