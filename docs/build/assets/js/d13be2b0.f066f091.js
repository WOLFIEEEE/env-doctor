"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[674],{4804(e,n,s){s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>x,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"frameworks/nextjs","title":"Next.js","description":"env-doctor has first-class support for Next.js applications.","source":"@site/docs/frameworks/nextjs.md","sourceDirName":"frameworks","slug":"/frameworks/nextjs","permalink":"/env-doctor/docs/frameworks/nextjs","draft":false,"unlisted":false,"editUrl":"https://github.com/khushwantparihar/env-doctor/tree/main/docs/docs/frameworks/nextjs.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"docsSidebar","previous":{"title":"Sync Check","permalink":"/env-doctor/docs/features/sync-check"},"next":{"title":"Vite","permalink":"/env-doctor/docs/frameworks/vite"}}');var i=s(4848),t=s(8453);const l={sidebar_position:1},c="Next.js",d={},o=[{value:"Auto-Detection",id:"auto-detection",level:2},{value:"Client vs Server Variables",id:"client-vs-server-variables",level:2},{value:"Validation Rules",id:"validation-rules",level:3},{value:"Environment Files",id:"environment-files",level:2},{value:"Configuration",id:"configuration",level:3},{value:"Auto-Ignored Variables",id:"auto-ignored-variables",level:2},{value:"App Router vs Pages Router",id:"app-router-vs-pages-router",level:2},{value:"App Router",id:"app-router",level:3},{value:"Pages Router",id:"pages-router",level:3},{value:"Common Issues",id:"common-issues",level:2},{value:"Missing NEXT_PUBLIC_ Prefix",id:"missing-next_public_-prefix",level:3},{value:"Exposing Secrets",id:"exposing-secrets",level:3},{value:"Runtime vs Build-time",id:"runtime-vs-build-time",level:3},{value:"Example Configuration",id:"example-configuration",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"nextjs",children:"Next.js"})}),"\n",(0,i.jsx)(n.p,{children:"env-doctor has first-class support for Next.js applications."}),"\n",(0,i.jsx)(n.h2,{id:"auto-detection",children:"Auto-Detection"}),"\n",(0,i.jsx)(n.p,{children:"env-doctor automatically detects Next.js projects by:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"next.config.js"}),", ",(0,i.jsx)(n.code,{children:"next.config.mjs"}),", or ",(0,i.jsx)(n.code,{children:"next.config.ts"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"next"})," in ",(0,i.jsx)(n.code,{children:"package.json"})," dependencies"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"client-vs-server-variables",children:"Client vs Server Variables"}),"\n",(0,i.jsxs)(n.p,{children:["Next.js uses the ",(0,i.jsx)(n.code,{children:"NEXT_PUBLIC_"})," prefix to expose variables to the browser:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Server-only (never sent to browser)\nDATABASE_URL=postgres://...\nAPI_SECRET=secret123\n\n# Client-accessible (bundled into JavaScript)\nNEXT_PUBLIC_API_URL=https://api.example.com\nNEXT_PUBLIC_GA_ID=UA-12345678\n"})}),"\n",(0,i.jsx)(n.h3,{id:"validation-rules",children:"Validation Rules"}),"\n",(0,i.jsx)(n.p,{children:"env-doctor warns when:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Client-side code accesses non-",(0,i.jsx)(n.code,{children:"NEXT_PUBLIC_"})," variables"]}),"\n",(0,i.jsxs)(n.li,{children:["Server-side secrets use ",(0,i.jsx)(n.code,{children:"NEXT_PUBLIC_"})," prefix (security risk)"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"\u26a0 Framework Convention Warning\n\n  DATABASE_URL\n    Variable is used in client component but doesn't have NEXT_PUBLIC_ prefix\n    at app/components/DataView.tsx:5\n"})}),"\n",(0,i.jsx)(n.h2,{id:"environment-files",children:"Environment Files"}),"\n",(0,i.jsx)(n.p,{children:"Next.js loads env files in this order:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"File"}),(0,i.jsx)(n.th,{children:"Loaded When"}),(0,i.jsx)(n.th,{children:"Commit?"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:".env"})}),(0,i.jsx)(n.td,{children:"Always"}),(0,i.jsx)(n.td,{children:"Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:".env.local"})}),(0,i.jsx)(n.td,{children:"Always (except test)"}),(0,i.jsx)(n.td,{children:"No"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:".env.development"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"next dev"})}),(0,i.jsx)(n.td,{children:"Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:".env.development.local"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"next dev"})}),(0,i.jsx)(n.td,{children:"No"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:".env.production"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"next build"})}),(0,i.jsx)(n.td,{children:"Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:".env.production.local"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"next build"})}),(0,i.jsx)(n.td,{children:"No"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:".env.test"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"NODE_ENV=test"})}),(0,i.jsx)(n.td,{children:"Yes"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:".env.test.local"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"NODE_ENV=test"})}),(0,i.jsx)(n.td,{children:"No"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// env-doctor.config.js\nmodule.exports = {\n  envFiles: [\n    '.env',\n    '.env.local',\n    '.env.development',\n    '.env.development.local'\n  ],\n  templateFile: '.env.example',\n  framework: 'nextjs'\n};\n"})}),"\n",(0,i.jsx)(n.p,{children:"Or target specific environment:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npx env-doctor --env production\n"})}),"\n",(0,i.jsx)(n.h2,{id:"auto-ignored-variables",children:"Auto-Ignored Variables"}),"\n",(0,i.jsx)(n.p,{children:"These Next.js/Vercel variables are automatically ignored:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"NEXT_TELEMETRY_DISABLED"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"NEXT_RUNTIME"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"VERCEL"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"VERCEL_ENV"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"VERCEL_URL"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"VERCEL_REGION"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"app-router-vs-pages-router",children:"App Router vs Pages Router"}),"\n",(0,i.jsx)(n.h3,{id:"app-router",children:"App Router"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"// app/page.tsx (Server Component)\nexport default function Page() {\n  // \u2705 Server-only - works fine\n  const dbUrl = process.env.DATABASE_URL;\n  \n  return <div>...</div>;\n}\n\n// app/components/ClientComponent.tsx\n'use client';\n\nexport default function ClientComponent() {\n  // \u2705 Correct - uses NEXT_PUBLIC_\n  const apiUrl = process.env.NEXT_PUBLIC_API_URL;\n  \n  // \u274c Warning - won't work in browser\n  const secret = process.env.API_SECRET;\n  \n  return <div>...</div>;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"pages-router",children:"Pages Router"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"// pages/index.tsx\nexport default function Page({ data }) {\n  // \u2705 Correct - client-side access\n  const apiUrl = process.env.NEXT_PUBLIC_API_URL;\n  \n  return <div>...</div>;\n}\n\nexport async function getServerSideProps() {\n  // \u2705 Server-only - works fine\n  const dbUrl = process.env.DATABASE_URL;\n  \n  return { props: { data: await fetchData(dbUrl) } };\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"common-issues",children:"Common Issues"}),"\n",(0,i.jsx)(n.h3,{id:"missing-next_public_-prefix",children:"Missing NEXT_PUBLIC_ Prefix"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem:"})," Variable not available in browser."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"// \u274c Won't work\nconst apiUrl = process.env.API_URL;\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Fix:"})," Add the prefix."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# .env\nNEXT_PUBLIC_API_URL=https://api.example.com\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"// \u2705 Works\nconst apiUrl = process.env.NEXT_PUBLIC_API_URL;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"exposing-secrets",children:"Exposing Secrets"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Problem:"})," Secret accessible in browser."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \u274c Security risk\nNEXT_PUBLIC_DATABASE_URL=postgres://user:pass@host/db\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Fix:"})," Remove prefix, access server-side only."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \u2705 Safe\nDATABASE_URL=postgres://user:pass@host/db\n"})}),"\n",(0,i.jsx)(n.h3,{id:"runtime-vs-build-time",children:"Runtime vs Build-time"}),"\n",(0,i.jsxs)(n.p,{children:["Next.js inlines ",(0,i.jsx)(n.code,{children:"NEXT_PUBLIC_"})," values at build time. For runtime configuration:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// next.config.js\nmodule.exports = {\n  publicRuntimeConfig: {\n    apiUrl: process.env.API_URL\n  }\n};\n\n// Usage\nimport getConfig from 'next/config';\nconst { publicRuntimeConfig } = getConfig();\nconst apiUrl = publicRuntimeConfig.apiUrl;\n"})}),"\n",(0,i.jsx)(n.h2,{id:"example-configuration",children:"Example Configuration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// env-doctor.config.js\nmodule.exports = {\n  envFiles: ['.env', '.env.local'],\n  templateFile: '.env.example',\n  include: [\n    'app/**/*.{ts,tsx}',\n    'pages/**/*.{ts,tsx}',\n    'src/**/*.{ts,tsx}',\n    'lib/**/*.{ts,tsx}'\n  ],\n  exclude: [\n    'node_modules',\n    '.next',\n    '**/*.test.*'\n  ],\n  framework: 'nextjs',\n  variables: {\n    DATABASE_URL: {\n      required: true,\n      secret: true,\n      pattern: /^postgres:\\/\\//\n    },\n    NEXT_PUBLIC_API_URL: {\n      required: true,\n      type: 'url'\n    }\n  }\n};\n"})})]})}function x(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453(e,n,s){s.d(n,{R:()=>l,x:()=>c});var r=s(6540);const i={},t=r.createContext(i);function l(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);